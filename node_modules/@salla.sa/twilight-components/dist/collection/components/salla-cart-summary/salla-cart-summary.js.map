{"version":3,"file":"salla-cart-summary.js","sourceRoot":"","sources":["../../../src/components/salla-cart-summary/salla-cart-summary.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, State, Method, Element, Prop } from '@stencil/core';\nimport CartIcon from \"../../assets/svg/cart.svg\"\nimport anime from 'animejs';\n\n@Component({\n  tag: 'salla-cart-summary',\n  styleUrl: 'salla-cart-summary.scss',\n})\nexport class SallaCartSummary {\n  constructor() {\n    salla.cart.event.onUpdated((response) => {\n      this.cartSummaryCount = response.count || 0;\n      this.cartSummaryTotal = response.total || 0;\n    });\n  }\n\n  @Element() host: HTMLElement;\n  @State() cartSummaryCount: number = salla.storage.get('cart.summary.count') || 0;\n  @State() cartSummaryTotal: number = salla.storage.get('cart.summary.total') || 0;\n  @State() cartLabel: string = salla.config.get('user.language_code') === 'ar' ? 'السلة' : 'Cart';\n\n  /**\n   * Show cart label\n   * */\n  @Prop() showCartLabel: boolean;\n\n\n  /**\n   * Animate product Image to cart summary\n   * @param image the image element to animate\n   */\n  @Method()\n  async animateToCart(image) {\n    document.querySelectorAll('.s-cart-thumb').forEach(el => el.remove());\n    if (!image?.src) {\n      salla.log('Failed to get the img element');\n      return;\n    }\n    let\n      cartBtn = this.host.querySelector('#s-cart-icon'),\n      btnOffset = cartBtn.getBoundingClientRect(),\n      btnTop = btnOffset.top + window.scrollY,\n      btnLeft = btnOffset.left + window.scrollX;\n\n    // get thumb position ---\n    let position = image.getBoundingClientRect(),\n      width = image.offsetWidth + 'px',\n      height = image.offsetHeight + 'px',\n      top = position.top,\n      left = position.left\n\n    // create thumb img element ---\n    let img = document.createElement(\"img\") as HTMLImageElement;\n    img.src = image.getAttribute('src');\n    img.className = \"s-cart-thumb\";\n    img.setAttribute(\"style\", \"object-fit:cover; width:\" + width + '; height:' + height + '; top:' + top + 'px; left:' + left + 'px;z-index:99999999; ')\n    document.body.append(img);\n\n    let cartThumb = document.querySelector('.s-cart-thumb');\n    cartBtn.classList.remove('animated', 'rubberBand');\n\n    // start timeline ---\n    let cartThumbAnime = new anime.timeline();\n    cartThumbAnime.add({\n      targets: cartThumb,\n      width: [150, 30],\n      height: [150, 30],\n      top: [top, window.scrollY > 0 ? btnTop - window.scrollY - 40 : btnTop - 40],\n      left: [left, btnLeft],\n      borderRadius: ['20%', '50%'],\n      easing: 'easeOutExpo',\n      duration: 1200,\n    }, '+=200')\n      .add({\n        targets: cartThumb,\n        width: [30, 0],\n        height: [30, 0],\n        opacity: [1, 0],\n        easing: 'easeOutExpo',\n        top: [window.scrollY > 0 ? btnTop - window.scrollY - 40 : btnTop - 40, window.scrollY > 0 ? btnTop - window.scrollY + 10 : btnTop + 10],\n        left: [btnLeft, btnLeft + 10],\n      }, '-=500')\n      .add({\n        complete: function () {\n          cartBtn.classList.add('animated', 'rubberBand');\n          cartThumb.remove();\n        },\n      }, '-=1700');\n  }\n\n  render() {\n    return (\n      <Host>\n        <a class=\"s-cart-summary-wrapper\" href={salla.url.get('cart')}>\n          <div id=\"s-cart-icon\">\n            <slot name=\"icon\"><i class=\"s-cart-summary-icon\" innerHTML={CartIcon}/></slot>\n          </div>\n          <span class=\"s-cart-summary-count\">{salla.helpers.number(this.cartSummaryCount)}</span>\n\n          <p class=\"s-cart-summary-content\">\n            {this.showCartLabel && <span class=\"s-cart-summary-label\">{this.cartLabel}</span>}\n            <b class=\"s-cart-summary-total\">{salla.money(this.cartSummaryTotal)}</b>\n          </p>\n        </a>\n      </Host>\n    );\n  }\n\n}\n"]}