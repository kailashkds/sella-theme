{"version":3,"file":"salla-count-down.js","sourceRoot":"","sources":["../../../src/components/salla-count-down/salla-count-down.tsx"],"names":[],"mappings":"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","sourcesContent":["import {Component, Host, h, Prop, State, Method} from '@stencil/core';\n\n@Component({\n  tag: 'salla-count-down',\n  styleUrl: 'salla-count-down.scss',\n})\nexport class SallaCountDown {\n  constructor() {\n\n    this.days = this.number(0);\n    this.hours = this.number(0);\n    this.minutes = this.number(0);\n    this.seconds = this.number(0);\n    salla.lang.onLoaded(() => {\n      this.daysLabel = salla.lang.get('pages.checkout.day');\n      this.hoursLabel = salla.lang.get('pages.checkout.hour');\n      this.minutesLabel = salla.lang.get('pages.checkout.minute');\n      this.invalidDate = salla.lang.get('blocks.buy_as_gift.incorrect_date');\n      this.secondsLabel = salla.lang.get('pages.checkout.second');\n      this.endLabel = salla.lang.get('pages.checkout.offer_ended');\n    });\n\n    if (this.date && this.isValidDate(this.date)) {\n      this.startCountDown();\n    }\n  }\n\n  /**\n   * The date to count down to\n   * Format: MMM DD, YYYY HH:mm:ss (e.g. Jan 2, 2023 16:37:52)\n   * */\n  @Prop() date: string;\n\n\n  /**\n   * If true, the count down numbers will be appear in a boxes\n   * */\n  @Prop() boxed: boolean;\n\n  /**\n   * The size of the count down\n   * */\n  @Prop() size: 'sm' | 'md' | 'lg' = 'md';\n\n  /**\n   * The color of the count down\n   * */\n  @Prop() color: 'primary' | 'light' | 'dark' = 'dark';\n\n  /**\n   * Show labels for each count down number\n   * */\n  @Prop() labeled: boolean;\n\n  /**\n   * The text to show when the count down ends\n   * */\n  @Prop() endText: string;\n\n\n  /**\n   * The digits lang to show in the count down\n   * */\n  @Prop() digits: 'en' | 'auto' = 'auto';\n\n  /**\n   * If true, the count down will end at the end of the day\n   * */\n  @Prop() endOfDay: boolean;\n\n  @State() daysLabel: string;\n  @State() hoursLabel: string;\n  @State() minutesLabel: string;\n  @State() secondsLabel: string;\n  @State() endLabel: string;\n  @State() invalidDate: string;\n  @State() offerEnded: boolean = false;\n  @State() countInterval: any;\n  @State() days: string;\n  @State() hours: string;\n  @State() minutes: string;\n  @State() seconds: string;\n\n\n  /**\n   * End the count down\n   * */\n  @Method()\n  async endCountDown() {\n    clearInterval(this.countInterval);\n    this.offerEnded = true;\n    this.days = this.number(0);\n    this.hours = this.number(0);\n    this.minutes = this.number(0);\n    this.seconds = this.number(0);\n  }\n\n  private isValidDate(date: string) {\n    let dateHasDashes = date.includes('-'),\n        dateParts = date.split(' '),\n        testedDate;\n    if (dateHasDashes) {\n      testedDate = dateParts[0].replace(/-/g, '/');\n    } else {\n      testedDate = dateParts[0];\n    }\n    return !isNaN(Date.parse(testedDate));\n  }\n\n  private number(digit: number) {\n    return salla.helpers.number(digit, this.digits === 'en');\n  }\n\n  private startCountDown() {\n\n    let countDownDate = new Date(this.date.replace(/-/g, \"/\"));\n    if (this.endOfDay || this.date.split(' ').length === 1) {\n      countDownDate.setHours(23, 59, 59, 999);\n    }\n    let countDownTime = countDownDate.getTime();\n\n    this.countInterval = setInterval(() => {\n      let now = new Date().getTime();\n      let distance = countDownTime - now;\n\n      this.days = this.number(Math.floor(distance / (1000 * 60 * 60 * 24)));\n      this.hours = this.number(Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)));\n      this.minutes = this.number(Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)));\n      this.seconds = this.number(Math.floor((distance % (1000 * 60)) / 1000));\n\n      if (distance < 0) {\n        this.endCountDown();\n      }\n    }, 1000);\n  }\n\n  render() {\n    if (!this.date) {\n      return \"\";\n    } else if (this.date && !this.isValidDate(this.date)) {\n      return <div class=\"s-count-down-text-center\">{this.invalidDate}</div>\n    }\n    return (\n      <Host class=\"s-count-down-wrapper\">\n        <ul\n          class={`s-count-down-list ${this.boxed ? 's-count-down-boxed' : ''} ${this.offerEnded ? 's-count-down-ended' : ''} s-count-down-${this.size} s-count-down-${this.color}`}>\n          <li class=\"s-count-down-item\">\n            <div class=\"s-count-down-item-value\">{this.seconds}</div>\n            {this.labeled && <div class=\"s-count-down-item-label\">{this.secondsLabel}</div>}\n          </li>\n          <li class=\"s-count-down-item\">\n            <div class=\"s-count-down-item-value\">{this.minutes}</div>\n            {this.labeled && <div class=\"s-count-down-item-label\">{this.minutesLabel}</div>}\n          </li>\n          <li class=\"s-count-down-item\">\n            <div class=\"s-count-down-item-value\">{this.hours}</div>\n            {this.labeled && <div class=\"s-count-down-item-label\">{this.hoursLabel}</div>}\n          </li>\n          <li class=\"s-count-down-item\">\n            <div class=\"s-count-down-item-value\">{this.days}</div>\n            {this.labeled && <div class=\"s-count-down-item-label\">{this.daysLabel}</div>}\n          </li>\n        </ul>\n\n        {this.offerEnded && <div class=\"s-count-down-end-text\">{!!this.endText ? this.endText : this.endLabel}</div>}\n      </Host>\n    );\n  }\n\n}\n"]}