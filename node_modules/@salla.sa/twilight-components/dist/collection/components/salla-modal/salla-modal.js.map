{"version":3,"file":"salla-modal.js","sourceRoot":"","sources":["../../../src/components/salla-modal/salla-modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, h, Host, Method, Prop, State, Watch, Event, EventEmitter, Listen } from '@stencil/core';\nimport CancelIcon from '../../assets/svg/cancel.svg';\nimport AlertEngineIcon from '../../assets/svg/alert-engine.svg';\nimport CheckCircleIcon from '../../assets/svg/check-circle2.svg';\nimport Helper from '../../Helpers/Helper';\n\n/**\n * @slot footer - The footer of modal\n */\n\n@Component({ tag: 'salla-modal', styleUrl: 'salla-modal.scss' })\nexport class SallaModal {\n  constructor() {\n    salla.event.on('modal::open', target => target == this.host.id && this.open());\n    salla.event.on('modal::close', target => target == this.host.id && this.close());\n    this.modalTitle = this.host.getAttribute('modal-title');\n  }\n\n  /**\n   * Sets the modal to be closable. Defaults to `true`\n   */\n  @Prop({ mutable: true }) isClosable: boolean = true;//todo::rename unclude. Suggestion => persistent\n  /**\n   * The size of the modal\n   */\n  @Prop({ reflect: true }) width: 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'full' = 'md';\n  /**\n   * The position of the modal\n   */\n  @Prop({ reflect: true }) position: 'top' | 'middle' | 'bottom' = 'middle';\n  /**\n   * open the modal on rendering\n   */\n  @Prop({ reflect: true }) visible: boolean = false;\n  /**\n   * open the modal on rendering\n   */\n  @Prop({ reflect: true }) hasSkeleton: boolean = false;\n  /**\n   * Show loading in the middle\n   */\n  @Prop({ reflect: true, mutable: true }) isLoading: boolean = false;\n\n  /**\n   * Show subtitle before the title or not, defaults to `false` (after the title)\n   */\n  @Prop() subTitleFirst: boolean = false;//todo:: choose better name\n\n  /**\n   * Avoid padding in the modal body or not, defaults to `false`\n   */\n  @Prop() noPadding: boolean = false;//todo:: choose better name\n\n  /**\n   * Set modal sub title.\n   */\n  @Prop() subTitle: string = '';\n\n  /**\n   * Align modal content to center, defaults to `false`\n   */\n  @Prop() centered: boolean = false;\n\n  /**\n   * Set the style of the header icon.\n   */\n  @Prop() iconStyle: 'error' | 'success' | 'primary' | 'normal' = undefined;\n\n  @State() modalTitle: string;\n\n  private overlay: HTMLElement;\n\n  @Element() host: HTMLElement;\n\n  /**\n   * Event emitted when the modal visibilty is changed.\n   */\n  @Event() modalVisibilityChanged: EventEmitter<Boolean>;\n\n  @Watch('visible')\n  handleVisible(newValue: boolean) {\n    if (!newValue) {\n      this.modalVisibilityChanged.emit(false);\n      this.toggleModal(false);\n      return;\n    }\n    this.modalVisibilityChanged.emit(true);\n    this.host.classList.remove('s-hidden');\n    setTimeout(() => this.toggleModal(true)); //small amont of time to running toggle After adding hidden\n  }\n\n  @Listen('keyup')\n  handleKeyUp(ev: KeyboardEvent) {\n    if (ev.key === \"KeyUp\") {\n      this.closeModal()\n    }\n  }\n\n  /**\n   * Open the modal\n   */\n  @Method()\n  async open() {\n    this.host.setAttribute('visible', '');\n    this.handleAutoFocus();\n    return this.host;\n  }\n\n  /**\n   * close the modal\n   */\n  @Method()\n  async close() {\n    this.host.removeAttribute('visible');\n    return this.host;\n  }\n\n  /**\n   * Change the Modal Title\n   * @param {string} modalTitle\n   */\n  @Method()\n  async setTitle(modalTitle) {\n    this.modalTitle = modalTitle;\n    return this.host;\n  }\n\n  /**\n   * Start loading\n   */\n  @Method()\n  async loading() {\n    this.isLoading = true;\n    return this.host;\n  }\n\n\n  /**\n   * Stop the loading\n   */\n  @Method()\n  async stopLoading() {\n    this.isLoading = false;\n    return this.host;\n  }\n\n  private handleAutoFocus() {\n    const firstFocusableElement = this.host.querySelector('input, textarea, select') as HTMLElement;\n    if (!firstFocusableElement) {\n      return;\n    }\n    setTimeout(() => {\n      firstFocusableElement.focus();\n    }, 100);\n  }\n\n  private toggleModal(isOpen) {\n    const body = this.host.querySelector('.s-modal-body');\n    Helper.toggleElementClassIf(body, 's-modal-entering', 's-modal-leaving', () => isOpen)\n      .toggleElementClassIf(this.overlay, 's-modal-entering', 's-modal-overlay-leaving', () => isOpen)\n      .toggleElementClassIf(document.body, 'modal-is-open', 'modal-is-closed', () => isOpen);\n    if (!isOpen) {\n      setTimeout(() => this.host.classList.add('s-hidden'), 350);\n    }\n  }\n\n  private closeModal() {\n    if (!this.isClosable) {\n      return;\n    }\n    this.host.removeAttribute('visible');\n  }\n\n  private iconBlockClasses() {\n    return {\n      's-modal-icon': true,\n      's-modal-bg-error': this.iconStyle == 'error',\n      's-modal-bg-success': this.iconStyle == 'success',\n      's-modal-bg-normal': !this.iconStyle,\n      's-modal-bg-primary': this.iconStyle == 'primary'\n    };\n  }\n\n  private getWidth() {\n    return this.isLoading ? (this.hasSkeleton ? 'md' : 'xs') : this.width\n  }\n\n  //todo:: pref for each modal\n  render() {\n    this.host.id = this.host.id || 'salla-modal';\n\n\n    if (this.isLoading) {\n      return (\n        <Host class='salla-modal s-modal s-modal-container s-hidden' aria-modal=\"true\" role=\"dialog\" onKeyUp={e => this.handleKeyUp(e)}>\n          <div class=\"s-modal-overlay\" ref={el => this.overlay = el} onClick={() => this.closeModal()} />\n          <div class=\"s-modal-wrapper\">\n            <span class={'s-modal-spacer s-modal-align-' + this.position}>&#8203;</span>\n            <div class={'s-modal-body ' + 's-modal-align-' + this.position + ' s-modal-' + this.getWidth() + (this.noPadding ? ' s-modal-nopadding' : ' s-modal-padding')}>\n              <slot name=\"loading\">\n                <salla-loading></salla-loading>\n              </slot>\n              {\n                // we have a limitations with StencilJS, when the component is not shadow\n                // all the dom of host append to component even if <slot /> is not in the render\n                // So we'll use a workaround, render all the slot as hidden when is loading\n                // @see https://github.com/ionic-team/stencil/issues/399\n              }\n              <div class=\"s-hidden\">\n                <slot />\n              </div>\n            </div>\n          </div>\n        </Host>\n      );\n    }\n\n\n    return (\n      <Host class='salla-modal s-modal s-modal-container s-hidden' aria-modal=\"true\" role=\"dialog\">\n        <div class=\"s-modal-overlay\" ref={el => this.overlay = el} onClick={() => this.closeModal()} />\n        <div class=\"s-modal-wrapper\">\n          <span class={'s-modal-spacer s-modal-align-' + this.position}>&#8203;</span>\n          <div\n            class={'s-modal-body ' + 's-modal-align-' + this.position + ' s-modal-' + this.getWidth() + (this.noPadding ? ' s-modal-nopadding' : ' s-modal-padding')}>\n            <div class={{ 's-modal-header': true, 's-modal-is-center': this.centered }}>\n              {this.isClosable ?\n                <button class=\"s-modal-close\" onClick={() => this.closeModal()} type=\"button\">\n                  <span innerHTML={CancelIcon} />\n                </button>\n                : ''}\n\n              {this.modalTitle || this.subTitle ?\n                <div class=\"s-modal-header-inner\">\n                  <slot name='icon'>\n                    {!!this.iconStyle ?\n                      <div class={this.iconBlockClasses()} innerHTML={this.iconStyle == 'error' ? AlertEngineIcon : CheckCircleIcon} />\n                      : ''\n                    }\n                  </slot>\n                  <div class=\"s-modal-header-content\">\n                    {this.modalTitle ? <div class={{ 's-modal-title': true, 's-modal-title-below': this.subTitleFirst }}\n                      innerHTML={this.modalTitle} /> : ''}\n                    {this.subTitle ? <p class={{ 's-modal-sub-title': true }} innerHTML={this.subTitle} /> : ''}\n                  </div>\n                </div>\n                : ''}\n            </div>\n            <slot />\n            <slot name=\"footer\" />\n\n          </div>\n        </div>\n      </Host>\n    );\n  }\n  //move the modal as root dom, because we need the model to be outside the forms\n  componentDidLoad() {\n    document.body.append(this.host);\n  }\n}\n"]}