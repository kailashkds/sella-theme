{"version":3,"names":["sallaPriceRangeCss","SallaPriceRange","constructor","hostRef","this","generatePriceOptions","async","minInput","value","_b","_a","option","values","min","maxInput","max","MAX_PRICE","option1","Math","floor","option2","option3","priceOptions","console","log","join","getPriceLabel","price","salla","money","handleMinMaxPrice","event","firstOption","secondOption","thirdOption","minPrice","maxPrice","Error","changedEventHandler","isMin","target","minInputValidation","minthumb","maxInputValidation","maxthumb","isReady","changed","emit","isChecked","render","h","Host","map","index","class","htmlFor","id","name","type","checked","onChange","e","config","currency","symbol","maxlength","ref","el","onInput","placeholder","componentDidLoad","filtersData"],"sources":["./src/components/salla-price-range/salla-price-range.scss?tag=salla-price-range","./src/components/salla-price-range/salla-price-range.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n\n\n.rtl, [dir=\"rtl\"] {\n  .rtl-range-slider {\n      transform: rotateY(180deg);\n  }\n\n  .rtl-range-numbers{\n      flex-direction: row-reverse;\n  }\n\n  .form-select, select{\n      background-position: left 0.5rem center;\n      padding-right: 12px;\n  }   \n\n  // divide\n.menu-divide {\n  li {\n      &:not(:last-child) {\n          &:after {\n              left: 0;\n              right: auto;\n          }\n      }\n  }\n}\n}\n\ninput[type=range]::-webkit-slider-thumb {\n  pointer-events: all;\n  width: 24px;\n  height: 24px;\n  -webkit-appearance: none;\n}\n\n[type='checkbox']:checked{\n  background-size: 80%;\n}","import { Component, Host, h, State, Prop, Event, Method } from '@stencil/core';\nimport { Filter } from \"../salla-filters/interfaces\";\n\n@Component({\n  tag: 'salla-price-range',\n  styleUrl: 'salla-price-range.scss',\n})\nexport class SallaPriceRange {\n  constructor() {\n    this.generatePriceOptions();\n  }\n  @Prop({ mutable: true }) minPrice = 1000;\n  @Prop({ mutable: true }) maxPrice = 5000;\n  @Prop({ reflect: true }) option: Filter;\n  @Prop({ reflect: true }) filtersData: any;\n  @State() min = 0;\n  @State() max = 10000;\n\n  @State() minthumb = 0;\n  @State() maxthumb = 0;\n  @State() priceOptions: any;\n\n  @Event() changed: any;\n\n  isReady: Boolean;\n  rightHandle: HTMLDivElement;\n  leftHandle: HTMLDivElement;\n  activeBar: HTMLDivElement;\n  minInput: HTMLInputElement;\n  maxInput: HTMLInputElement;\n\n  @Method()\n  async reset() {\n    //@ts-ignore\n    this.minInput.value = `${this.option?.values?.min || 0}`;\n    this.maxInput.value = `${this.max}`;\n  }\n\n  private generatePriceOptions() {\n    const MAX_PRICE = this.max;\n    let option1 = Math.floor(MAX_PRICE / 100);\n    if (option1 < 1) {\n      option1 = Math.floor(MAX_PRICE / 10);\n    }\n    let option2 = Math.floor(MAX_PRICE / 2);\n    let option3 = Math.floor((MAX_PRICE / 3) * 2);\n    this.priceOptions = [option1, option2, option3];\n\n    // to be removed\n    console.log(`Price options for max price ${MAX_PRICE}: ${this.priceOptions.join(', ')}`);\n  }\n  private getPriceLabel(price) {\n    if (price == Math.floor(this.max / 100)) {\n      return `اقل من ${salla.money(price)}`;\n    } else if (price == Math.floor(this.max / 2)) {\n      return `${salla.money(this.priceOptions[0])} الى ${salla.money(this.priceOptions[2])}`;\n    } else {\n      return `أكثر من ${salla.money(price)}`;\n    }\n  }\n\n  private handleMinMaxPrice(event: Event, option: string): void {\n    const [firstOption, secondOption, thirdOption] = this.priceOptions;\n    switch (option) {\n      case firstOption:\n        this.minPrice = 0;\n        this.maxPrice = firstOption;\n        break;\n      case secondOption:\n        this.minPrice = firstOption;\n        this.maxPrice = thirdOption;\n        break;\n      case thirdOption:\n        this.minPrice = thirdOption;\n        this.maxPrice = this.max;\n        break;\n      default:\n        throw new Error(`Invalid price option: ${option}`);\n    }\n\n    // Update the input values\n    this.minInput.value = `${this.minPrice}`;\n    this.maxInput.value = `${this.maxPrice}`;\n    this.changedEventHandler(event);\n  }\n\n  private async changedEventHandler(event, isMin = false) {\n\n    let value = event ? event.target.value * 1 : null\n    if (isMin) {\n      this.minInputValidation(value);\n      this.minthumb = ((this.minPrice - this.min) / (this.max - this.min)) * 100;\n    } else {\n      this.maxInputValidation(value)\n      this.maxthumb = 100 - (((this.maxPrice - this.min) / (this.max - this.min)) * 100);\n    }\n\n\n    this.isReady && this.changed.emit({\n      event: event,\n      option: this.option,\n      value: { max: this.maxPrice, min: this.minPrice }\n    })\n  }\n\n\n  minInputValidation(value) {\n    if (value && (value > this.max || value > this.maxPrice)) {\n      // this.minPrice = this.maxPrice;\n      return;\n    }\n\n    if (value < this.min) {\n      this.minPrice = this.min;\n      return;\n    }\n\n    if (value) {\n      this.minPrice = value;\n    }\n  }\n\n  maxInputValidation(value) {\n    if (value && (value < this.min || value < this.minPrice)) {\n      // this.maxPrice = this.minPrice;\n      return;\n    }\n    if (value > this.max) {\n      this.maxPrice = this.max;\n      return;\n    }\n\n    if (value) {\n      this.maxPrice = value;\n    }\n  }\n  private isChecked(option) {\n    if (option == Math.floor(this.max / 100)) {\n      return this.minPrice == 0 && this.maxPrice == option;\n    }\n    if (option == Math.floor(this.max / 2)) {\n      return this.minPrice == this.priceOptions[0] && this.maxPrice == this.priceOptions[2];\n    }\n    if (option == Math.floor((this.max / 3) * 2)) {\n\n      return this.minPrice == option && this.maxPrice == this.max;\n    }\n  }\n\n\n  render() {\n    return (\n      <Host>\n        {\n          this.priceOptions && this.priceOptions.map((option, index) => {\n            return <label class=\"s-filters-label\" htmlFor={`${option}-${index}`}>\n              <input\n                id={`${option}-${index}`}\n                name=\"price\"\n                type=\"radio\"\n                checked={this.isChecked(option)}\n                class=\"s-filters-radio\"\n                onChange={e => this.handleMinMaxPrice(e, option)}\n              />\n              {this.getPriceLabel(option)}\n            </label>\n          })\n        }\n\n\n        <div class=\"flex justify-center items-center\">\n          <div class=\"relative max-w-xl w-full\">\n            <div class=\"s-price-range-inputs\">\n              <div class=\"s-price-range-relative\">\n                <div class=\"s-price-range-currency\"> {salla.config.currency().symbol}</div>\n                <input\n                  type=\"number\"\n                  maxlength=\"5\"\n                  ref={el => this.minInput = el}\n                  onInput={(event) => this.changedEventHandler(event, true)}\n                  // value={this.minPrice}\n                  placeholder=\"من\"\n                  class=\"s-price-range-number-input\"\n                />\n              </div>\n\n              <div class=\"s-price-range-gray-text\"> -</div>\n              <div class=\"s-price-range-relative\">\n                <div class=\"s-price-range-currency\"> {salla.config.currency().symbol}</div>\n                <input type=\"number\" maxlength=\"5\"\n                  placeholder=\"الى\"\n                  ref={el => this.maxInput = el}\n                  onInput={(event) => this.changedEventHandler(event)}\n                  // value={this.maxPrice}\n                  class=\"s-price-range-number-input\" aria-describedby=\"price-currency\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n\n  componentDidLoad() {\n    if (this.filtersData && this.filtersData?.price) {\n      this.minPrice = this.filtersData.price.min;\n      this.maxPrice = this.filtersData.price.max;\n      this.maxInput.value = `${this.maxPrice}`;\n      this.minInput.value = `${this.minPrice}`;\n    }\n    this.isReady = true;\n  }\n}\n"],"mappings":"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"}