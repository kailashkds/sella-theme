{"version":3,"names":["sallaFiltersWidgetCss","SallaFiltersWidget","exports","this","initHeight","class_1","prototype","connectedCallback","withLoadMore","Array","isArray","option","values","length","widgetTitle","label","componentDidLoad","widgetValues","scrollHeight","style","maxHeight","concat","widgetContent","height","reset","type","FilterOptionTypes","RANGE","priceRange","from","host","querySelectorAll","forEach","input","checked","showMore","isShowMore","setTimeout","_this","toggleWidget","isOpen","Helper","toggleElementClassIf","renderFilterOption","VALUES","MINIMUM","VARIANTS","includes","map","filterOption","index","value","key","h","class","htmlFor","id","name","inputType","isSelectedOption","onChange","e","changed","emit","event","getOptionLabel","filtersData","FilterOptionInputType","CHECKBOX","size","render","Host","onClick","ref","el","onChanged","detail","price"],"sources":["src/components/salla-filters-widget/salla-filters-widget.scss?tag=salla-filters-widget","src/components/salla-filters-widget/salla-filters-widget.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import {Component, Host, h, Method, State, Prop, Event, Element} from '@stencil/core';\nimport Helper from '../../Helpers/Helper';\nimport {Filter, FilterOptionInputType, FilterOptionTypes} from \"../salla-filters/interfaces\";\n\n@Component({\n  tag: 'salla-filters-widget',\n  styleUrl: 'salla-filters-widget.scss',\n})\nexport class SallaFiltersWidget {\n  @Element() host: HTMLElement;\n  @Prop({mutable: true}) widgetTitle: string;\n  @Prop({mutable: true}) withLoadMore: boolean;\n  @Prop({reflect: true}) filtersData: object;\n  @Prop({reflect: true}) option: Filter;\n  priceRange: HTMLSallaPriceRangeElement\n\n\n  private widgetValues: HTMLElement;\n  private widgetContent: HTMLDivElement;\n  private initHeight: number = 195;\n  @State() isOpen: boolean = true;\n  @State() isShowMore: boolean = false;\n\n  @Event() changed: any;\n\n  connectedCallback() {\n    //lets be smart and don't show 5 and more link for 8 options\n    this.withLoadMore = Array.isArray(this.option.values) && this.option.values.length > 8;\n    this.widgetTitle = this.option.label;\n  }\n\n  componentDidLoad() {\n    this.widgetValues.scrollHeight < this.initHeight && (this.withLoadMore = false);\n    (this.withLoadMore && this.widgetValues) && (this.widgetValues.style.maxHeight = `${this.initHeight}px`);\n    this.widgetContent.style.height = `${this.widgetContent.scrollHeight}px`;\n  }\n\n  @Method()\n  async reset() {\n    if (this.option.type === FilterOptionTypes.RANGE) {\n      this.priceRange.reset()\n    }\n    Array.from(this.host.querySelectorAll('input')).forEach(input => input.checked = false);\n  }\n\n\n  @Method()\n  async showMore() {\n    this.isShowMore = !this.isShowMore\n    this.widgetContent.style.height = 'auto';\n    this.widgetValues.style.maxHeight = this.isShowMore ? `${this.widgetValues.scrollHeight}px` : `${this.initHeight}px`;\n    setTimeout(() => {\n      this.widgetContent.style.height = `${this.widgetContent.scrollHeight}px`;\n    }, 400); // get height after time of collapse animtion (duration-300)\n  }\n\n  @Method()\n  async toggleWidget() {\n    this.isOpen = !this.isOpen;\n    Helper.toggleElementClassIf(this.widgetContent, 's-filters-widget-opened', 's-filters-widget-closed', () => this.isOpen);\n  }\n\n  renderFilterOption(option: Filter) {\n    if (![FilterOptionTypes.VALUES, FilterOptionTypes.MINIMUM, FilterOptionTypes.VARIANTS].includes(option.type)) {\n      return '';\n    }\n    //@ts-ignore\n    return option.values.map((filterOption, index) => {\n        let value = typeof filterOption == 'number' ? filterOption : (filterOption.key || filterOption.value);\n\n        return <label class=\"s-filters-label\" htmlFor={`${option.key}-option-${index}`}>\n          <input\n            id={`${option.key}-option-${index}`}\n            name={option.key}\n            type={option.inputType}\n            //TODO:: debug more why sometimes it's not rendered as selectedðŸ¤¨\n            checked={this.isSelectedOption(option, value)}\n            class={`s-filters-${option.inputType}`}\n            onChange={e => this.changed.emit({event: e, option: option, value: value})}\n          />\n          {this.getOptionLabel(option, filterOption)}\n        </label>\n      }\n    )\n  }\n\n  private isSelectedOption(option: Filter, value) {\n    if (!this.filtersData || !this.filtersData[option.key]) {\n      return false\n    }\n\n    return option.inputType === FilterOptionInputType.CHECKBOX\n      ? this.filtersData[option.key].includes(value)\n      : this.filtersData[option.key] == value;\n  }\n\n  private getOptionLabel(option: Filter, filterOption) {\n    if (option.key == 'rating') {\n      //in amazon has stars & up, should we add it, to avoid those people who will come to say I selected 4 why I see 5 sars products\n      return <salla-rating-stars size=\"small\" value={filterOption}/>;\n    }\n    let label = filterOption.value || 'null';\n    //label+=filterOption.count ? ` (${salla.helpers.number(filterOption.count)})` : '';\n    return <span class=\"s-filters-option-name\">{label}</span>;\n  }\n\n  render() {\n    return (\n      <Host class=\"s-filters-widget-container\">\n        <h3 class=\"s-filters-widget-title\" onClick={() => this.toggleWidget()}>\n          <span>{this.widgetTitle}</span>\n          <span class={`s-filters-widget-plusminus ${this.isOpen ? 's-filters-widget-plusminus-active' : ''}`}/>\n        </h3>\n        <div class=\"s-filters-widget-content\" ref={(el) => this.widgetContent = el}>\n          <div class=\"s-filters-widget-values\" ref={(el) => this.widgetValues = el}>\n            <slot/>\n            {\n              this.option.type !== FilterOptionTypes.RANGE\n                ? this.renderFilterOption(this.option)\n                : <salla-price-range onChanged={(event) => this.changed.emit(event.detail)}\n                                     ref={price => this.priceRange = price}\n                                     filtersData={this.filtersData}\n                                     option={this.option}/>\n            }\n          </div>\n          {this.withLoadMore &&\n          <a class=\"s-filters-widget-more\"\n             onClick={() => this.showMore()}>{!this.isShowMore ? 'Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯' : 'Ø¹Ø±Ø¶ Ø£Ù‚Ù„'}</a>\n          }\n        </div>\n      </Host>\n    );\n  }\n\n}\n"],"mappings":"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"}