/*!
 * Crafted with ❤ by Salla
 */
import{r as t,c as s,h as i,H as e,g as a}from"./p-3c7d3f26.js";import{F as l,a as r}from"./p-d3cc3770.js";const n=":host{display:block}.s-rating-stars-small{line-height:12px}.s-filters-radio{background-image:none !important}";const o=class{constructor(i){t(this,i);this.changed=s(this,"changed",7);this.isReady=false;this.filters=undefined;this.isSidebarOpen=undefined;this.filtersData={};this.apply=undefined;this.reset=undefined;salla.event.on("filters::hidden",(()=>this.host.style.display="none"));salla.lang.onLoaded((()=>{this.apply=salla.lang.get("pages.checkout.apply");this.reset=salla.lang.get("pages.categories.filters_reset")}));salla.event.on("filters::fetched",(({filters:t})=>{this.host.style.display="";let s={};this.filters=t.map((t=>{t.label={category_id:salla.lang.get("common.titles.categories"),brand_id:salla.lang.get("common.titles.brands"),rating:salla.lang.get("pages.categories.filter_rating"),price_range:salla.lang.get("pages.categories.filter_price")}[t.key]||t.label;t.inputType=l.CHECKBOX;if(t.key=="rating"){t.inputType=l.RADIO;let{max:s,min:i}=t.values;t.values=[5,4,3,2,1].filter((t=>t>=i||t<=s))}if(this.filtersData[t.key]){s[t.key]=this.filtersData[t.key]}return t}));this.filtersData=s}))}connectedCallback(){try{let t=new URLSearchParams(window.location.search).get("filters");this.filtersData=t?JSON.parse(decodeURIComponent(t)):{}}catch(t){salla.logger.warn("failed to get filters from url",t.message)}}async getFilters(){return this.filtersData}async applyFilters(){if(!this.isReady){return}window.scrollTo({top:0,behavior:"smooth"});setTimeout((()=>{window.history.pushState({},"",salla.url.addParamToUrl("filters",encodeURIComponent(JSON.stringify(this.filtersData))));salla.event.emit("salla-filters::changed",this.filtersData);this.changed.emit(this.filtersData)}),300)}async resetFilters(){this.filtersData={};this.host.childNodes.forEach((t=>t.reset&&t.reset()));salla.event.emit("salla-filters::reset");return this.applyFilters()}handleOptionChange(t,s,i){if(s.type===r.RANGE){this.filtersData[s.key]=i;return}let e=t.target.checked;if(t.target.type==l.RADIO){e&&(this.filtersData[s.key]=i);e||delete this.filtersData[s.key];return}this.filtersData[s.key]=this.filtersData[s.key]||[];if(e){this.filtersData[s.key].push(i);return}this.filtersData[s.key]=this.filtersData[s.key].filter((t=>t!=i))}render(){var t,s;return i(e,null,(t=this.filters)===null||t===void 0?void 0:t.map((t=>i("salla-filters-widget",{option:t,filtersData:this.filtersData,onChanged:({detail:{event:t,option:s,value:i}})=>this.handleOptionChange(t,s,i)}))),((s=this.filters)===null||s===void 0?void 0:s.length)&&i("div",{class:"s-filters-footer"},i("salla-button",{color:"primary",onClick:()=>this.applyFilters()},this.apply),i("salla-button",{color:"gray",fill:"outline",onClick:()=>this.resetFilters()},this.reset)))}componentDidLoad(){this.isReady=true}get host(){return a(this)}};o.style=n;export{o as salla_filters};
//# sourceMappingURL=p-cd5cb2f7.entry.js.map