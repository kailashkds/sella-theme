{"version":3,"names":["sallaPriceRangeCss","SallaPriceRange","exports","class_1","hostRef","this","generatePriceOptions","prototype","reset","minInput","value","concat","_b","_a","option","values","min","maxInput","max","MAX_PRICE","option1","Math","floor","option2","option3","priceOptions","console","log","join","getPriceLabel","price","salla","money","handleMinMaxPrice","event","_c","firstOption","secondOption","thirdOption","minPrice","maxPrice","Error","changedEventHandler","isMin","target","minInputValidation","minthumb","maxInputValidation","maxthumb","isReady","changed","emit","isChecked","render","_this","h","Host","map","index","class","htmlFor","id","name","type","checked","onChange","e","config","currency","symbol","maxlength","ref","el","onInput","placeholder","componentDidLoad","filtersData"],"sources":["src/components/salla-price-range/salla-price-range.scss?tag=salla-price-range","src/components/salla-price-range/salla-price-range.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n\n\n.rtl, [dir=\"rtl\"] {\n  .rtl-range-slider {\n      transform: rotateY(180deg);\n  }\n\n  .rtl-range-numbers{\n      flex-direction: row-reverse;\n  }\n\n  .form-select, select{\n      background-position: left 0.5rem center;\n      padding-right: 12px;\n  }   \n\n  // divide\n.menu-divide {\n  li {\n      &:not(:last-child) {\n          &:after {\n              left: 0;\n              right: auto;\n          }\n      }\n  }\n}\n}\n\ninput[type=range]::-webkit-slider-thumb {\n  pointer-events: all;\n  width: 24px;\n  height: 24px;\n  -webkit-appearance: none;\n}\n\n[type='checkbox']:checked{\n  background-size: 80%;\n}","import { Component, Host, h, State, Prop, Event, Method } from '@stencil/core';\nimport { Filter } from \"../salla-filters/interfaces\";\n\n@Component({\n  tag: 'salla-price-range',\n  styleUrl: 'salla-price-range.scss',\n})\nexport class SallaPriceRange {\n  constructor() {\n    this.generatePriceOptions();\n  }\n  @Prop({ mutable: true }) minPrice = 1000;\n  @Prop({ mutable: true }) maxPrice = 5000;\n  @Prop({ reflect: true }) option: Filter;\n  @Prop({ reflect: true }) filtersData: any;\n  @State() min = 0;\n  @State() max = 10000;\n\n  @State() minthumb = 0;\n  @State() maxthumb = 0;\n  @State() priceOptions: any;\n\n  @Event() changed: any;\n\n  isReady: Boolean;\n  rightHandle: HTMLDivElement;\n  leftHandle: HTMLDivElement;\n  activeBar: HTMLDivElement;\n  minInput: HTMLInputElement;\n  maxInput: HTMLInputElement;\n\n  @Method()\n  async reset() {\n    //@ts-ignore\n    this.minInput.value = `${this.option?.values?.min || 0}`;\n    this.maxInput.value = `${this.max}`;\n  }\n\n  private generatePriceOptions() {\n    const MAX_PRICE = this.max;\n    let option1 = Math.floor(MAX_PRICE / 100);\n    if (option1 < 1) {\n      option1 = Math.floor(MAX_PRICE / 10);\n    }\n    let option2 = Math.floor(MAX_PRICE / 2);\n    let option3 = Math.floor((MAX_PRICE / 3) * 2);\n    this.priceOptions = [option1, option2, option3];\n\n    // to be removed\n    console.log(`Price options for max price ${MAX_PRICE}: ${this.priceOptions.join(', ')}`);\n  }\n  private getPriceLabel(price) {\n    if (price == Math.floor(this.max / 100)) {\n      return `اقل من ${salla.money(price)}`;\n    } else if (price == Math.floor(this.max / 2)) {\n      return `${salla.money(this.priceOptions[0])} الى ${salla.money(this.priceOptions[2])}`;\n    } else {\n      return `أكثر من ${salla.money(price)}`;\n    }\n  }\n\n  private handleMinMaxPrice(event: Event, option: string): void {\n    const [firstOption, secondOption, thirdOption] = this.priceOptions;\n    switch (option) {\n      case firstOption:\n        this.minPrice = 0;\n        this.maxPrice = firstOption;\n        break;\n      case secondOption:\n        this.minPrice = firstOption;\n        this.maxPrice = thirdOption;\n        break;\n      case thirdOption:\n        this.minPrice = thirdOption;\n        this.maxPrice = this.max;\n        break;\n      default:\n        throw new Error(`Invalid price option: ${option}`);\n    }\n\n    // Update the input values\n    this.minInput.value = `${this.minPrice}`;\n    this.maxInput.value = `${this.maxPrice}`;\n    this.changedEventHandler(event);\n  }\n\n  private async changedEventHandler(event, isMin = false) {\n\n    let value = event ? event.target.value * 1 : null\n    if (isMin) {\n      this.minInputValidation(value);\n      this.minthumb = ((this.minPrice - this.min) / (this.max - this.min)) * 100;\n    } else {\n      this.maxInputValidation(value)\n      this.maxthumb = 100 - (((this.maxPrice - this.min) / (this.max - this.min)) * 100);\n    }\n\n\n    this.isReady && this.changed.emit({\n      event: event,\n      option: this.option,\n      value: { max: this.maxPrice, min: this.minPrice }\n    })\n  }\n\n\n  minInputValidation(value) {\n    if (value && (value > this.max || value > this.maxPrice)) {\n      // this.minPrice = this.maxPrice;\n      return;\n    }\n\n    if (value < this.min) {\n      this.minPrice = this.min;\n      return;\n    }\n\n    if (value) {\n      this.minPrice = value;\n    }\n  }\n\n  maxInputValidation(value) {\n    if (value && (value < this.min || value < this.minPrice)) {\n      // this.maxPrice = this.minPrice;\n      return;\n    }\n    if (value > this.max) {\n      this.maxPrice = this.max;\n      return;\n    }\n\n    if (value) {\n      this.maxPrice = value;\n    }\n  }\n  private isChecked(option) {\n    if (option == Math.floor(this.max / 100)) {\n      return this.minPrice == 0 && this.maxPrice == option;\n    }\n    if (option == Math.floor(this.max / 2)) {\n      return this.minPrice == this.priceOptions[0] && this.maxPrice == this.priceOptions[2];\n    }\n    if (option == Math.floor((this.max / 3) * 2)) {\n\n      return this.minPrice == option && this.maxPrice == this.max;\n    }\n  }\n\n\n  render() {\n    return (\n      <Host>\n        {\n          this.priceOptions && this.priceOptions.map((option, index) => {\n            return <label class=\"s-filters-label\" htmlFor={`${option}-${index}`}>\n              <input\n                id={`${option}-${index}`}\n                name=\"price\"\n                type=\"radio\"\n                checked={this.isChecked(option)}\n                class=\"s-filters-radio\"\n                onChange={e => this.handleMinMaxPrice(e, option)}\n              />\n              {this.getPriceLabel(option)}\n            </label>\n          })\n        }\n\n\n        <div class=\"flex justify-center items-center\">\n          <div class=\"relative max-w-xl w-full\">\n            <div class=\"s-price-range-inputs\">\n              <div class=\"s-price-range-relative\">\n                <div class=\"s-price-range-currency\"> {salla.config.currency().symbol}</div>\n                <input\n                  type=\"number\"\n                  maxlength=\"5\"\n                  ref={el => this.minInput = el}\n                  onInput={(event) => this.changedEventHandler(event, true)}\n                  // value={this.minPrice}\n                  placeholder=\"من\"\n                  class=\"s-price-range-number-input\"\n                />\n              </div>\n\n              <div class=\"s-price-range-gray-text\"> -</div>\n              <div class=\"s-price-range-relative\">\n                <div class=\"s-price-range-currency\"> {salla.config.currency().symbol}</div>\n                <input type=\"number\" maxlength=\"5\"\n                  placeholder=\"الى\"\n                  ref={el => this.maxInput = el}\n                  onInput={(event) => this.changedEventHandler(event)}\n                  // value={this.maxPrice}\n                  class=\"s-price-range-number-input\" aria-describedby=\"price-currency\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n\n  componentDidLoad() {\n    if (this.filtersData && this.filtersData?.price) {\n      this.minPrice = this.filtersData.price.min;\n      this.maxPrice = this.filtersData.price.max;\n      this.maxInput.value = `${this.maxPrice}`;\n      this.minInput.value = `${this.minPrice}`;\n    }\n    this.isReady = true;\n  }\n}\n"],"mappings":";;;6JAAA,IAAMA,EAAqB,0nB,ICOdC,EAAeC,EAAA,+BAC1B,SAAAC,EAAAC,G,yDAGoC,I,cACA,I,0DAGrB,E,SACA,I,cAEK,E,cACA,E,4BAVlBC,KAAKC,sB,CAuBDH,EAAAI,UAAAC,MAAN,W,6FAEEH,KAAKI,SAASC,MAAQ,GAAAC,SAAGC,GAAAC,EAAAR,KAAKS,UAAM,MAAAD,SAAA,SAAAA,EAAEE,UAAM,MAAAH,SAAA,SAAAA,EAAEI,MAAO,GACrDX,KAAKY,SAASP,MAAQ,GAAAC,OAAGN,KAAKa,K,iBAGxBf,EAAAI,UAAAD,qBAAA,WACN,IAAMa,EAAYd,KAAKa,IACvB,IAAIE,EAAUC,KAAKC,MAAMH,EAAY,KACrC,GAAIC,EAAU,EAAG,CACfA,EAAUC,KAAKC,MAAMH,EAAY,G,CAEnC,IAAII,EAAUF,KAAKC,MAAMH,EAAY,GACrC,IAAIK,EAAUH,KAAKC,MAAOH,EAAY,EAAK,GAC3Cd,KAAKoB,aAAe,CAACL,EAASG,EAASC,GAGvCE,QAAQC,IAAI,+BAAAhB,OAA+BQ,EAAS,MAAAR,OAAKN,KAAKoB,aAAaG,KAAK,O,EAE1EzB,EAAAI,UAAAsB,cAAA,SAAcC,GACpB,GAAIA,GAAST,KAAKC,MAAMjB,KAAKa,IAAM,KAAM,CACvC,MAAO,UAAAP,OAAUoB,MAAMC,MAAMF,G,MACxB,GAAIA,GAAST,KAAKC,MAAMjB,KAAKa,IAAM,GAAI,CAC5C,MAAO,GAAAP,OAAGoB,MAAMC,MAAM3B,KAAKoB,aAAa,IAAG,SAAAd,OAAQoB,MAAMC,MAAM3B,KAAKoB,aAAa,I,KAC5E,CACL,MAAO,WAAAd,OAAWoB,MAAMC,MAAMF,G,GAI1B3B,EAAAI,UAAA0B,kBAAA,SAAkBC,EAAcpB,GAChC,IAAAqB,EAA2C9B,KAAKoB,aAA/CW,EAAWD,EAAA,GAAEE,EAAYF,EAAA,GAAEG,EAAWH,EAAA,GAC7C,OAAQrB,GACN,KAAKsB,EACH/B,KAAKkC,SAAW,EAChBlC,KAAKmC,SAAWJ,EAChB,MACF,KAAKC,EACHhC,KAAKkC,SAAWH,EAChB/B,KAAKmC,SAAWF,EAChB,MACF,KAAKA,EACHjC,KAAKkC,SAAWD,EAChBjC,KAAKmC,SAAWnC,KAAKa,IACrB,MACF,QACE,MAAM,IAAIuB,MAAM,yBAAA9B,OAAyBG,IAI7CT,KAAKI,SAASC,MAAQ,GAAAC,OAAGN,KAAKkC,UAC9BlC,KAAKY,SAASP,MAAQ,GAAAC,OAAGN,KAAKmC,UAC9BnC,KAAKqC,oBAAoBR,E,EAGb/B,EAAAI,UAAAmC,oBAAN,SAA0BR,EAAOS,GAAA,GAAAA,SAAA,GAAAA,EAAA,KAAa,C,2FAEhDjC,EAAQwB,EAAQA,EAAMU,OAAOlC,MAAQ,EAAI,KAC7C,GAAIiC,EAAO,CACTtC,KAAKwC,mBAAmBnC,GACxBL,KAAKyC,UAAazC,KAAKkC,SAAWlC,KAAKW,MAAQX,KAAKa,IAAMb,KAAKW,KAAQ,G,KAClE,CACLX,KAAK0C,mBAAmBrC,GACxBL,KAAK2C,SAAW,KAAS3C,KAAKmC,SAAWnC,KAAKW,MAAQX,KAAKa,IAAMb,KAAKW,KAAQ,G,CAIhFX,KAAK4C,SAAW5C,KAAK6C,QAAQC,KAAK,CAChCjB,MAAOA,EACPpB,OAAQT,KAAKS,OACbJ,MAAO,CAAEQ,IAAKb,KAAKmC,SAAUxB,IAAKX,KAAKkC,Y,iBAK3CpC,EAAAI,UAAAsC,mBAAA,SAAmBnC,GACjB,GAAIA,IAAUA,EAAQL,KAAKa,KAAOR,EAAQL,KAAKmC,UAAW,CAExD,M,CAGF,GAAI9B,EAAQL,KAAKW,IAAK,CACpBX,KAAKkC,SAAWlC,KAAKW,IACrB,M,CAGF,GAAIN,EAAO,CACTL,KAAKkC,SAAW7B,C,GAIpBP,EAAAI,UAAAwC,mBAAA,SAAmBrC,GACjB,GAAIA,IAAUA,EAAQL,KAAKW,KAAON,EAAQL,KAAKkC,UAAW,CAExD,M,CAEF,GAAI7B,EAAQL,KAAKa,IAAK,CACpBb,KAAKmC,SAAWnC,KAAKa,IACrB,M,CAGF,GAAIR,EAAO,CACTL,KAAKmC,SAAW9B,C,GAGZP,EAAAI,UAAA6C,UAAA,SAAUtC,GAChB,GAAIA,GAAUO,KAAKC,MAAMjB,KAAKa,IAAM,KAAM,CACxC,OAAOb,KAAKkC,UAAY,GAAKlC,KAAKmC,UAAY1B,C,CAEhD,GAAIA,GAAUO,KAAKC,MAAMjB,KAAKa,IAAM,GAAI,CACtC,OAAOb,KAAKkC,UAAYlC,KAAKoB,aAAa,IAAMpB,KAAKmC,UAAYnC,KAAKoB,aAAa,E,CAErF,GAAIX,GAAUO,KAAKC,MAAOjB,KAAKa,IAAM,EAAK,GAAI,CAE5C,OAAOb,KAAKkC,UAAYzB,GAAUT,KAAKmC,UAAYnC,KAAKa,G,GAK5Df,EAAAI,UAAA8C,OAAA,eAAAC,EAAAjD,KACE,OACEkD,EAACC,EAAI,KAEDnD,KAAKoB,cAAgBpB,KAAKoB,aAAagC,KAAI,SAAC3C,EAAQ4C,GAClD,OAAOH,EAAA,SAAOI,MAAM,kBAAkBC,QAAS,GAAAjD,OAAGG,EAAM,KAAAH,OAAI+C,IAC1DH,EAAA,SACEM,GAAI,GAAAlD,OAAGG,EAAM,KAAAH,OAAI+C,GACjBI,KAAK,QACLC,KAAK,QACLC,QAASV,EAAKF,UAAUtC,GACxB6C,MAAM,kBACNM,SAAU,SAAAC,GAAK,OAAAZ,EAAKrB,kBAAkBiC,EAAGpD,EAA1B,IAEhBwC,EAAKzB,cAAcf,G,IAM1ByC,EAAA,OAAKI,MAAM,oCACTJ,EAAA,OAAKI,MAAM,4BACTJ,EAAA,OAAKI,MAAM,wBACTJ,EAAA,OAAKI,MAAM,0BACTJ,EAAA,OAAKI,MAAM,0BAAwB,IAAG5B,MAAMoC,OAAOC,WAAWC,QAC9Dd,EAAA,SACEQ,KAAK,SACLO,UAAU,IACVC,IAAK,SAAAC,GAAM,OAAAlB,EAAK7C,SAAW+D,CAAhB,EACXC,QAAS,SAACvC,GAAU,OAAAoB,EAAKZ,oBAAoBR,EAAO,KAAhC,EAEpBwC,YAAY,KACZf,MAAM,gCAIVJ,EAAA,OAAKI,MAAM,2BAAyB,MACpCJ,EAAA,OAAKI,MAAM,0BACTJ,EAAA,OAAKI,MAAM,0BAAwB,IAAG5B,MAAMoC,OAAOC,WAAWC,QAC9Dd,EAAA,SAAOQ,KAAK,SAASO,UAAU,IAC7BI,YAAY,MACZH,IAAK,SAAAC,GAAM,OAAAlB,EAAKrC,SAAWuD,CAAhB,EACXC,QAAS,SAACvC,GAAU,OAAAoB,EAAKZ,oBAAoBR,EAAzB,EAEpByB,MAAM,6BAA4B,mBAAkB,uB,EASpExD,EAAAI,UAAAoE,iBAAA,W,MACE,GAAItE,KAAKuE,eAAe/D,EAAAR,KAAKuE,eAAW,MAAA/D,SAAA,SAAAA,EAAEiB,OAAO,CAC/CzB,KAAKkC,SAAWlC,KAAKuE,YAAY9C,MAAMd,IACvCX,KAAKmC,SAAWnC,KAAKuE,YAAY9C,MAAMZ,IACvCb,KAAKY,SAASP,MAAQ,GAAAC,OAAGN,KAAKmC,UAC9BnC,KAAKI,SAASC,MAAQ,GAAAC,OAAGN,KAAKkC,S,CAEhClC,KAAK4C,QAAU,I,WA3MS,I"}