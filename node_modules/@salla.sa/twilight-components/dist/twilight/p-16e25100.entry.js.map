{"version":3,"names":["sallaCommentFormCss","SallaCommentForm","constructor","hostRef","salla","lang","get","onLoaded","this","placeholder","submitText","onReady","canComment","config","itemId","type","url","is_page","submit","commentForm","reportValidity","log","submitBtn","load","then","comment","add","id","commentField","value","finally","stop","render","h","Host","ref","frm","class","showAvatar","src","alt","cols","rows","minlength","maxlength","field","required","btn","onClick"],"sources":["./src/components/salla-comment-form/salla-comment-form.scss?tag=salla-comment-form","./src/components/salla-comment-form/salla-comment-form.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import {Component, Host, State, h, Prop} from '@stencil/core';\n\n@Component({\n  tag: 'salla-comment-form',\n  styleUrl: 'salla-comment-form.scss',\n})\nexport class SallaCommentForm {\n\n  constructor() {\n    salla.lang.onLoaded(() => {\n      this.placeholder = salla.lang.get('blocks.comments.placeholder')\n      this.submitText = salla.lang.get('blocks.comments.submit')\n    });\n    salla.onReady(() => {\n      this.canComment = salla.config.get('user.can_comment');\n      this.itemId = salla.config.get('page.id');\n      this.type = salla.url.is_page('page-single') ? 'page' : 'product';\n    });\n  }\n\n  /**\n   * Type of entity the comment is being submitted for. Defaults to `salla.url.is_page('page-single') ? 'page' : 'product'`\n   */\n  @Prop({mutable: true, reflect: true}) type: 'product' | 'page';\n\n  /**\n   * To show the avatar or not in the comment form\n   */\n  @Prop() showAvatar: boolean;\n\n  /**\n   * The ID of the item(as defined in the type), where the comment is for. defaults to `salla.config.get('page.id')`\n   */\n  @Prop({mutable: true, reflect: true}) itemId?: string | number;\n\n  @State() placeholder: string = salla.lang.get('blocks.comments.placeholder');\n  @State() submitText: string = salla.lang.get('blocks.comments.submit');\n  @State() canComment: boolean;\n\n  private commentField: HTMLTextAreaElement;\n  private submitBtn: HTMLSallaButtonElement;\n  private commentForm: HTMLFormElement;\n\n\n  private submit() {\n    if (!this.commentForm.reportValidity()) {\n      salla.log('CommentForm:: validation error!');\n      return;\n    }\n    this.submitBtn.load()\n      .then(() => salla.comment.add({id: this.itemId, comment: this.commentField.value, type: this.type}))\n      .finally(() => this.submitBtn.stop);\n  }\n\n  render() {\n    return (\n      <Host>\n        {!!this.canComment ? <form ref={frm => this.commentForm = frm}>\n          <div class=\"s-comment-form-wrapper\">\n            {this.showAvatar ?\n              <img class=\"s-comment-form-avatar\" src={salla.config.get('user.avatar')} alt=\"user avatar\"/> : ''}\n            <div class=\"s-comment-form-content\">\n              <textarea cols={30} rows={5} minlength=\"4\" maxlength=\"500\"\n                        ref={field => this.commentField = field}\n                        placeholder={this.placeholder}\n                        class=\"s-comment-form-input\"\n                        required/>\n              <br/>\n              <div class=\"s-comment-form-action\">\n                <salla-button ref={btn => this.submitBtn = btn} loader-position='center' onClick={() => this.submit()}>\n                  {this.submitText}\n                </salla-button>\n              </div>\n            </div>\n          </div>\n        </form> : ''}\n      </Host>\n    );\n  }\n}\n"],"mappings":";;;kDAAA,MAAMA,EAAsB,uB,MCMfC,EAAgB,MAE3BC,YAAAC,G,+FA2B+BC,MAAMC,KAAKC,IAAI,+B,gBAChBF,MAAMC,KAAKC,IAAI,0B,0BA3B3CF,MAAMC,KAAKE,UAAS,KAClBC,KAAKC,YAAcL,MAAMC,KAAKC,IAAI,+BAClCE,KAAKE,WAAaN,MAAMC,KAAKC,IAAI,yBAAyB,IAE5DF,MAAMO,SAAQ,KACZH,KAAKI,WAAaR,MAAMS,OAAOP,IAAI,oBACnCE,KAAKM,OAASV,MAAMS,OAAOP,IAAI,WAC/BE,KAAKO,KAAOX,MAAMY,IAAIC,QAAQ,eAAiB,OAAS,SAAS,G,CA4B7DC,SACN,IAAKV,KAAKW,YAAYC,iBAAkB,CACtChB,MAAMiB,IAAI,mCACV,M,CAEFb,KAAKc,UAAUC,OACZC,MAAK,IAAMpB,MAAMqB,QAAQC,IAAI,CAACC,GAAInB,KAAKM,OAAQW,QAASjB,KAAKoB,aAAaC,MAAOd,KAAMP,KAAKO,SAC5Fe,SAAQ,IAAMtB,KAAKc,UAAUS,M,CAGlCC,SACE,OACEC,EAACC,EAAI,OACA1B,KAAKI,WAAaqB,EAAA,QAAME,IAAKC,GAAO5B,KAAKW,YAAciB,GACxDH,EAAA,OAAKI,MAAM,0BACR7B,KAAK8B,WACJL,EAAA,OAAKI,MAAM,wBAAwBE,IAAKnC,MAAMS,OAAOP,IAAI,eAAgBkC,IAAI,gBAAkB,GACjGP,EAAA,OAAKI,MAAM,0BACTJ,EAAA,YAAUQ,KAAM,GAAIC,KAAM,EAAGC,UAAU,IAAIC,UAAU,MAC3CT,IAAKU,GAASrC,KAAKoB,aAAeiB,EAClCpC,YAAaD,KAAKC,YAClB4B,MAAM,uBACNS,SAAQ,OAClBb,EAAA,WACAA,EAAA,OAAKI,MAAM,yBACTJ,EAAA,gBAAcE,IAAKY,GAAOvC,KAAKc,UAAYyB,EAAG,kBAAkB,SAASC,QAAS,IAAMxC,KAAKU,UAC1FV,KAAKE,gBAKN,G"}